<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Good Dog Spa</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/png" href="../favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/utilities.css">
    <style>
        :root { --sidebar-width: 260px; }
        body { min-height: 100vh; background: var(--color-gray-50); }
        .portal-layout { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar { width: var(--sidebar-width); background: #1e293b; color: var(--color-white); position: fixed; top: 0; left: 0; bottom: 0; overflow-y: auto; z-index: 1000; }
        @media (max-width: 1023px) { .sidebar { transform: translateX(-100%); transition: transform 0.3s; } .sidebar.open { transform: translateX(0); } }
        .sidebar-header { padding: var(--space-6); border-bottom: 1px solid rgba(255,255,255,0.1); }
        .sidebar-logo { height: 45px; filter: brightness(0) invert(1); }
        .admin-badge { display: inline-block; background: var(--color-coral); color: white; font-size: var(--font-size-xs); padding: 2px 8px; border-radius: var(--radius-full); margin-left: var(--space-2); }
        .sidebar-user { padding: var(--space-5); background: rgba(255,255,255,0.05); margin: var(--space-4); border-radius: var(--radius-xl); }
        .sidebar-user-avatar { width: 50px; height: 50px; background: linear-gradient(135deg, var(--color-coral), #ef4444); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin-bottom: var(--space-3); }
        .sidebar-user-name { font-weight: var(--font-weight-bold); margin-bottom: var(--space-1); }
        .sidebar-user-email { font-size: var(--font-size-sm); color: rgba(255,255,255,0.6); }
        .sidebar-nav { padding: var(--space-4); }
        .sidebar-nav-label { font-size: var(--font-size-xs); text-transform: uppercase; letter-spacing: 0.1em; color: rgba(255,255,255,0.4); padding: var(--space-3) var(--space-4); margin-top: var(--space-4); }
        .sidebar-nav-label:first-child { margin-top: 0; }
        .sidebar-link { display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: rgba(255,255,255,0.7); border-radius: var(--radius-lg); margin-bottom: var(--space-1); cursor: pointer; }
        .sidebar-link:hover { background: rgba(255,255,255,0.1); color: var(--color-white); }
        .sidebar-link.active { background: var(--color-coral); color: var(--color-white); }
        .sidebar-footer { padding: var(--space-4); border-top: 1px solid rgba(255,255,255,0.1); position: absolute; bottom: 0; left: 0; right: 0; }
        .logout-btn { display: flex; align-items: center; gap: var(--space-3); width: 100%; padding: var(--space-3) var(--space-4); color: rgba(255,255,255,0.6); border-radius: var(--radius-lg); cursor: pointer; }
        .logout-btn:hover { background: rgba(255,255,255,0.1); color: var(--color-coral); }
        
        /* Main Content */
        .portal-main { flex: 1; margin-left: var(--sidebar-width); min-height: 100vh; }
        @media (max-width: 1023px) { .portal-main { margin-left: 0; } }
        .portal-topbar { background: var(--color-white); padding: var(--space-4) var(--space-6); display: flex; align-items: center; justify-content: space-between; box-shadow: var(--shadow-sm); position: sticky; top: 0; z-index: 100; }
        .mobile-menu-toggle { display: none; width: 44px; height: 44px; align-items: center; justify-content: center; font-size: 1.5rem; background: var(--color-gray-100); border-radius: var(--radius-lg); cursor: pointer; }
        @media (max-width: 1023px) { .mobile-menu-toggle { display: flex; } }
        .page-title h1 { font-size: var(--font-size-xl); margin: 0; }
        .portal-content { padding: var(--space-6); }
        @media (min-width: 768px) { .portal-content { padding: var(--space-8); } }
        .sidebar-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); opacity: 0; visibility: hidden; z-index: 999; transition: all 0.3s; }
        .sidebar-overlay.open { opacity: 1; visibility: visible; }
        
        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }
        
        /* Stats */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-5); margin-bottom: var(--space-8); }
        .stat-card { background: var(--color-white); border-radius: var(--radius-xl); padding: var(--space-5); box-shadow: var(--shadow-sm); display: flex; align-items: center; gap: var(--space-4); }
        .stat-icon { width: 55px; height: 55px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; border-radius: var(--radius-xl); }
        .stat-icon.blue { background: var(--color-blue-light); }
        .stat-icon.yellow { background: var(--color-yellow-light); }
        .stat-icon.green { background: #dcfce7; }
        .stat-icon.coral { background: #fee2e2; }
        .stat-info h3 { font-size: var(--font-size-2xl); margin-bottom: 0; }
        .stat-info p { color: var(--color-gray-500); font-size: var(--font-size-sm); margin: 0; }
        
        /* Cards */
        .admin-card { background: var(--color-white); border-radius: var(--radius-xl); box-shadow: var(--shadow-sm); overflow: hidden; margin-bottom: var(--space-6); }
        .admin-card-header { padding: var(--space-5); border-bottom: 1px solid var(--color-gray-100); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--space-3); }
        .admin-card-header h2 { margin: 0; font-size: var(--font-size-lg); }
        .admin-card-body { padding: var(--space-5); }
        
        /* Filters */
        .filters-row { display: flex; flex-wrap: wrap; gap: var(--space-3); align-items: center; }
        .filter-input, .filter-select { padding: var(--space-2) var(--space-4); border: 2px solid var(--color-gray-200); border-radius: var(--radius-lg); font-size: var(--font-size-sm); min-width: 140px; }
        .filter-input:focus, .filter-select:focus { border-color: var(--color-blue-primary); outline: none; }
        
        /* Tables */
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th, .data-table td { padding: var(--space-3) var(--space-4); text-align: left; border-bottom: 1px solid var(--color-gray-100); }
        .data-table th { background: var(--color-gray-50); font-weight: var(--font-weight-bold); font-size: var(--font-size-sm); color: var(--color-gray-600); white-space: nowrap; }
        .data-table tr:hover { background: var(--color-gray-50); }
        .data-table-wrapper { overflow-x: auto; }
        
        /* Status Badges */
        .status-badge { display: inline-block; padding: var(--space-1) var(--space-3); border-radius: var(--radius-full); font-size: var(--font-size-xs); font-weight: var(--font-weight-bold); }
        .status-badge.confirmed { background: #dcfce7; color: #16a34a; }
        .status-badge.completed { background: var(--color-blue-light); color: var(--color-blue-primary); }
        .status-badge.cancelled { background: #fee2e2; color: #dc2626; }
        .status-badge.pending { background: var(--color-yellow-light); color: #b45309; }
        .status-badge.active { background: #dcfce7; color: #16a34a; }
        
        /* Item Rows */
        .item-row { display: flex; align-items: center; gap: var(--space-3); }
        .item-avatar { width: 40px; height: 40px; border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; font-size: 1rem; flex-shrink: 0; overflow: hidden; }
        .item-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .item-avatar.dog { background: var(--color-yellow-light); }
        .item-avatar.member { background: var(--color-blue-light); }
        .item-info h4 { margin: 0; font-size: var(--font-size-sm); }
        .item-info p { margin: 0; font-size: var(--font-size-xs); color: var(--color-gray-500); }
        
        /* Schedule */
        .schedule-item { display: flex; align-items: center; gap: var(--space-4); padding: var(--space-3) 0; border-bottom: 1px solid var(--color-gray-100); }
        .schedule-item:last-child { border-bottom: none; }
        .schedule-time { font-weight: var(--font-weight-bold); color: var(--color-blue-primary); min-width: 60px; }
        .schedule-info { flex: 1; }
        .schedule-info h4 { margin: 0 0 2px 0; font-size: var(--font-size-sm); }
        .schedule-info p { margin: 0; font-size: var(--font-size-xs); color: var(--color-gray-500); }
        
        /* Empty State */
        .empty-state { text-align: center; padding: var(--space-8); color: var(--color-gray-500); }
        .empty-state-icon { font-size: 3rem; margin-bottom: var(--space-3); }
        
        /* Action Buttons */
        .action-btn { padding: var(--space-1) var(--space-3); border-radius: var(--radius-lg); font-size: var(--font-size-xs); font-weight: var(--font-weight-bold); cursor: pointer; border: none; transition: all 0.2s; }
        .action-btn.confirm { background: #dcfce7; color: #16a34a; }
        .action-btn.confirm:hover { background: #16a34a; color: white; }
        .action-btn.cancel { background: #fee2e2; color: #dc2626; }
        .action-btn.cancel:hover { background: #dc2626; color: white; }
        .action-btn.edit { background: var(--color-blue-light); color: var(--color-blue-primary); }
        .action-btn.edit:hover { background: var(--color-blue-primary); color: white; }
        
        /* Modal - using admin-modal to avoid conflict with components.css */
        .admin-modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 9999; display: flex; align-items: center; justify-content: center; padding: var(--space-4); opacity: 0; visibility: hidden; transition: all 0.3s; }
        .admin-modal.open { opacity: 1; visibility: visible; }
        .admin-modal .admin-modal-backdrop { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); }
        .admin-modal .admin-modal-content { position: relative; z-index: 1; background: var(--color-white); border-radius: var(--radius-2xl); width: 100%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .admin-modal .admin-modal-header { padding: var(--space-5) var(--space-6); border-bottom: 1px solid var(--color-gray-100); display: flex; align-items: center; justify-content: space-between; }
        .admin-modal .admin-modal-header h2 { font-size: var(--font-size-xl); margin: 0; }
        .admin-modal .admin-modal-close { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; background: var(--color-gray-100); border-radius: var(--radius-full); cursor: pointer; font-size: 1.2rem; }
        .admin-modal .admin-modal-close:hover { background: var(--color-coral); color: white; }
        .admin-modal .admin-modal-body { padding: var(--space-6); }
        .admin-modal .admin-modal-footer { padding: var(--space-4) var(--space-6); background: var(--color-gray-50); display: flex; gap: var(--space-3); justify-content: flex-end; }
        
        /* Form */
        .form-group { margin-bottom: var(--space-4); }
        .form-group label { display: block; font-weight: var(--font-weight-bold); margin-bottom: var(--space-2); font-size: var(--font-size-sm); }
        .form-group input, .form-group select { width: 100%; padding: var(--space-3); border: 2px solid var(--color-gray-200); border-radius: var(--radius-lg); font-size: var(--font-size-base); }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--color-blue-primary); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); }
        
        /* Credits Display */
        .credits-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: var(--space-3); margin-bottom: var(--space-4); }
        .credit-item { background: var(--color-gray-50); padding: var(--space-3); border-radius: var(--radius-lg); text-align: center; }
        .credit-item .count { font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); color: var(--color-blue-primary); }
        .credit-item .label { font-size: var(--font-size-xs); color: var(--color-gray-500); }
        .credit-adjust { display: flex; align-items: center; gap: var(--space-2); }
        .credit-adjust button { width: 32px; height: 32px; border-radius: var(--radius-full); border: none; font-size: 1.2rem; cursor: pointer; }
        .credit-adjust .minus { background: #fee2e2; color: #dc2626; }
        .credit-adjust .plus { background: #dcfce7; color: #16a34a; }
        .credit-adjust input { width: 60px; text-align: center; padding: var(--space-2); border: 2px solid var(--color-gray-200); border-radius: var(--radius-lg); }
        
        /* Grid */
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-6); }
        @media (max-width: 900px) { .grid-2 { grid-template-columns: 1fr; } }
        
        /* Date Accordion */
        .date-accordion { margin-bottom: var(--space-4); }
        .date-header { background: var(--color-gray-50); padding: var(--space-4) var(--space-5); border-radius: var(--radius-xl); cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; }
        .date-header:hover { background: var(--color-gray-100); }
        .date-header.open { border-radius: var(--radius-xl) var(--radius-xl) 0 0; background: var(--color-blue-primary); color: white; }
        .date-header h3 { margin: 0; font-size: var(--font-size-base); display: flex; align-items: center; gap: var(--space-2); }
        .date-header .date-count { font-size: var(--font-size-sm); opacity: 0.8; }
        .date-header .toggle-icon { transition: transform 0.2s; }
        .date-header.open .toggle-icon { transform: rotate(180deg); }
        .date-content { display: none; padding: var(--space-4); background: var(--color-white); border: 2px solid var(--color-gray-100); border-top: none; border-radius: 0 0 var(--radius-xl) var(--radius-xl); }
        .date-content.open { display: block; }
        
        .service-section { margin-bottom: var(--space-5); }
        .service-section:last-child { margin-bottom: 0; }
        .service-section-header { font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); color: var(--color-gray-500); margin-bottom: var(--space-3); padding-bottom: var(--space-2); border-bottom: 1px dashed var(--color-gray-200); }
        
        /* Booking Cards */
        .booking-cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: var(--space-3); }
        .booking-card-mini { background: var(--color-gray-50); border-radius: var(--radius-lg); padding: var(--space-4); display: flex; gap: var(--space-3); }
        .booking-card-mini .dog-avatar { width: 50px; height: 50px; border-radius: var(--radius-lg); background: var(--color-yellow-light); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; overflow: hidden; flex-shrink: 0; }
        .booking-card-mini .dog-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .booking-card-mini .booking-info { flex: 1; min-width: 0; }
        .booking-card-mini .booking-info h4 { margin: 0 0 2px 0; font-size: var(--font-size-sm); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .booking-card-mini .booking-info p { margin: 0; font-size: var(--font-size-xs); color: var(--color-gray-500); }
        .booking-card-mini .booking-info .time { font-weight: var(--font-weight-bold); color: var(--color-blue-primary); }
        .booking-card-mini .edit-btn { width: 30px; height: 30px; border-radius: var(--radius-full); background: var(--color-blue-light); color: var(--color-blue-primary); display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem; align-self: center; flex-shrink: 0; }
        .booking-card-mini .edit-btn:hover { background: var(--color-blue-primary); color: white; }
        
        /* Dog Cards */
        .dogs-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--space-4); }
        .dog-card { background: var(--color-white); border: 2px solid var(--color-gray-100); border-radius: var(--radius-xl); overflow: hidden; transition: all 0.2s; cursor: pointer; }
        .dog-card:hover { border-color: var(--color-blue-primary); box-shadow: var(--shadow-md); }
        .dog-card-main { padding: var(--space-4); display: flex; gap: var(--space-4); }
        .dog-card-avatar { width: 70px; height: 70px; border-radius: var(--radius-xl); background: var(--color-yellow-light); display: flex; align-items: center; justify-content: center; font-size: 2rem; overflow: hidden; flex-shrink: 0; }
        .dog-card-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .dog-card-info { flex: 1; min-width: 0; }
        .dog-card-info h3 { margin: 0 0 var(--space-1) 0; font-size: var(--font-size-lg); }
        .dog-card-info .owner { font-size: var(--font-size-sm); color: var(--color-gray-500); margin-bottom: var(--space-2); }
        .dog-card-tags { display: flex; gap: var(--space-2); flex-wrap: wrap; }
        .dog-card-tags span { font-size: var(--font-size-xs); padding: 2px 8px; background: var(--color-gray-100); border-radius: var(--radius-full); }
        .dog-card-expand { display: flex; align-items: center; justify-content: center; padding: var(--space-2); color: var(--color-gray-400); font-size: 0.8rem; }
        
        .dog-card-details { display: none; padding: var(--space-4); background: var(--color-gray-50); border-top: 1px solid var(--color-gray-100); }
        .dog-card.expanded .dog-card-details { display: block; }
        .dog-card.expanded .dog-card-expand span { transform: rotate(180deg); }
        .detail-row { display: flex; justify-content: space-between; padding: var(--space-2) 0; font-size: var(--font-size-sm); }
        .detail-row:not(:last-child) { border-bottom: 1px dashed var(--color-gray-200); }
        .detail-label { color: var(--color-gray-500); }
        .detail-value { font-weight: var(--font-weight-bold); }
        .dog-card-actions { display: flex; gap: var(--space-2); margin-top: var(--space-3); }
        
        /* Schedule Cards (for Overview) */
        .schedule-cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: var(--space-3); }
        .schedule-card { background: var(--color-gray-50); border-radius: var(--radius-lg); padding: var(--space-3); display: flex; gap: var(--space-3); align-items: center; }
        .schedule-card .time { font-weight: var(--font-weight-bold); color: var(--color-blue-primary); font-size: var(--font-size-sm); min-width: 50px; }
        .schedule-card .avatar { width: 36px; height: 36px; border-radius: var(--radius-full); background: var(--color-yellow-light); display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0; }
        .schedule-card .avatar img { width: 100%; height: 100%; object-fit: cover; }
        .schedule-card .info { flex: 1; min-width: 0; }
        .schedule-card .info h4 { margin: 0; font-size: var(--font-size-sm); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .schedule-card .info p { margin: 0; font-size: var(--font-size-xs); color: var(--color-gray-500); }
        .schedule-card.hydro { border-left: 3px solid var(--color-blue-primary); }
        .schedule-card.daycare { border-left: 3px solid var(--color-yellow-primary); }
        
        /* Quick Actions */
        .quick-actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: var(--space-3); margin-top: var(--space-6); }
        .quick-action-btn { display: flex; flex-direction: column; align-items: center; gap: var(--space-2); padding: var(--space-4); background: var(--color-white); border: 2px solid var(--color-gray-200); border-radius: var(--radius-xl); cursor: pointer; transition: all 0.2s; text-align: center; }
        .quick-action-btn:hover { border-color: var(--color-blue-primary); background: var(--color-blue-light); }
        .quick-action-btn .icon { font-size: 1.5rem; }
        .quick-action-btn span { font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); color: var(--color-gray-700); }

        /* Blog Posts Grid */
        .blog-posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: var(--space-4); }
        .blog-post-card { background: var(--color-white); border: 2px solid var(--color-gray-100); border-radius: var(--radius-xl); overflow: hidden; transition: all 0.2s; }
        .blog-post-card:hover { border-color: var(--color-blue-primary); box-shadow: var(--shadow-md); }
        .blog-post-image { width: 100%; height: 150px; object-fit: cover; background: var(--color-gray-100); }
        .blog-post-content { padding: var(--space-4); }
        .blog-post-category { display: inline-block; font-size: var(--font-size-xs); background: var(--color-blue-light); color: var(--color-blue-primary); padding: 2px 8px; border-radius: var(--radius-full); margin-bottom: var(--space-2); }
        .blog-post-content h3 { margin: 0 0 var(--space-2) 0; font-size: var(--font-size-base); }
        .blog-post-content p { color: var(--color-gray-500); font-size: var(--font-size-sm); margin: 0 0 var(--space-3) 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .blog-post-meta { display: flex; justify-content: space-between; align-items: center; font-size: var(--font-size-xs); color: var(--color-gray-400); }
        .blog-post-actions { display: flex; gap: var(--space-2); margin-top: var(--space-3); padding-top: var(--space-3); border-top: 1px solid var(--color-gray-100); }

        /* Gallery Grid */
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: var(--space-4); }
        .gallery-item { position: relative; border-radius: var(--radius-xl); overflow: hidden; aspect-ratio: 1; cursor: pointer; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .gallery-item:hover img { transform: scale(1.05); }
        .gallery-item-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.5); opacity: 0; transition: opacity 0.2s; display: flex; flex-direction: column; justify-content: flex-end; padding: var(--space-3); }
        .gallery-item:hover .gallery-item-overlay { opacity: 1; }
        .gallery-item-overlay p { color: white; font-size: var(--font-size-sm); margin: 0 0 var(--space-2) 0; }
        .gallery-item-overlay .delete-btn { position: absolute; top: var(--space-2); right: var(--space-2); width: 30px; height: 30px; background: #dc2626; color: white; border: none; border-radius: var(--radius-full); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }

        /* Dog Details in Modal */
        .dog-detail-header { display: flex; gap: var(--space-5); align-items: center; margin-bottom: var(--space-5); padding-bottom: var(--space-4); border-bottom: 2px dashed var(--color-gray-200); }
        .dog-detail-avatar { width: 100px; height: 100px; border-radius: var(--radius-xl); background: var(--color-yellow-light); display: flex; align-items: center; justify-content: center; font-size: 3rem; overflow: hidden; flex-shrink: 0; }
        .dog-detail-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .dog-detail-info h3 { margin: 0 0 var(--space-1) 0; font-size: var(--font-size-xl); }
        .dog-detail-info p { margin: 0; color: var(--color-gray-500); }
        .dog-detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3); }
        .dog-detail-item { padding: var(--space-3); background: var(--color-gray-50); border-radius: var(--radius-lg); }
        .dog-detail-item .label { font-size: var(--font-size-xs); color: var(--color-gray-500); margin-bottom: 2px; }
        .dog-detail-item .value { font-weight: var(--font-weight-bold); }
        .dog-notes-section { margin-top: var(--space-4); padding-top: var(--space-4); border-top: 1px solid var(--color-gray-200); }
        .dog-notes-section h4 { font-size: var(--font-size-sm); margin: 0 0 var(--space-2) 0; }
        .dog-notes-section p { font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0; background: var(--color-gray-50); padding: var(--space-3); border-radius: var(--radius-lg); }
    </style>
</head>
<body>
    <div class="portal-layout">
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
        
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="../index.html"><img src="https://wigramvet.co.nz/wp-content/uploads/2019/01/gooddogspa-2.png" alt="Good Dog Spa" class="sidebar-logo"></a>
                <span class="admin-badge">ADMIN</span>
            </div>
            <div class="sidebar-user" id="sidebarUser">
                <div class="sidebar-user-avatar">üë§</div>
                <div class="sidebar-user-name">Spa Admin</div>
                <div class="sidebar-user-email">admin@gooddogspa.co.nz</div>
            </div>
            <nav class="sidebar-nav">
                <div class="sidebar-nav-label">Admin Menu</div>
                <a class="sidebar-link active" data-tab="overview"><span class="sidebar-link-icon">üìä</span>Overview</a>
                <a class="sidebar-link" data-tab="bookings"><span class="sidebar-link-icon">üìÖ</span>All Bookings</a>
                <a class="sidebar-link" data-tab="dogs"><span class="sidebar-link-icon">üêï</span>All Dogs</a>
                <a class="sidebar-link" data-tab="members"><span class="sidebar-link-icon">üë•</span>Members</a>

                <div class="sidebar-nav-label">Content</div>
                <a class="sidebar-link" data-tab="blog"><span class="sidebar-link-icon">üìù</span>Blog Posts</a>
                <a class="sidebar-link" data-tab="gallery"><span class="sidebar-link-icon">üì∏</span>Gallery</a>

                <div class="sidebar-nav-label">Quick Links</div>
                <a href="../index.html" class="sidebar-link"><span class="sidebar-link-icon">üåê</span>Main Website</a>
            </nav>
            <div class="sidebar-footer">
                <button class="logout-btn" onclick="logout()"><span>üö™</span> Sign Out</button>
            </div>
        </aside>
        
        <main class="portal-main">
            <div class="portal-topbar">
                <button class="mobile-menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
                <div class="page-title"><h1 id="pageTitle">Admin Overview</h1></div>
                <div class="topbar-date" id="currentDate"></div>
            </div>
            
            <div class="portal-content">
                <!-- Overview Tab -->
                <div class="tab-panel active" id="tab-overview">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon blue">üìÖ</div>
                            <div class="stat-info">
                                <h3 id="statTodayBookings">0</h3>
                                <p>Today's Bookings</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon yellow">üêï</div>
                            <div class="stat-info">
                                <h3 id="statTotalDogs">0</h3>
                                <p>Registered Dogs</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon green">üë•</div>
                            <div class="stat-info">
                                <h3 id="statTotalMembers">0</h3>
                                <p>Active Members</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon coral">üìÜ</div>
                            <div class="stat-info">
                                <h3 id="statWeekBookings">0</h3>
                                <p>This Week</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üìÖ Today's Schedule</h2>
                            <span id="todayDate"></span>
                        </div>
                        <div class="admin-card-body">
                            <div id="todaySchedule" class="schedule-cards">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üì≠</div>
                                    <p>No bookings today</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>‚ö° Quick Actions</h2>
                        </div>
                        <div class="admin-card-body">
                            <div class="quick-actions">
                                <button class="quick-action-btn" onclick="openAddBookingModal()">
                                    <span class="icon">üìÖ</span>
                                    <span>New Booking</span>
                                </button>
                                <button class="quick-action-btn" onclick="alert('Dog registration would open here')">
                                    <span class="icon">üêï</span>
                                    <span>New Dog</span>
                                </button>
                                <button class="quick-action-btn" onclick="switchToTab('members')">
                                    <span class="icon">üí≥</span>
                                    <span>Update Credits</span>
                                </button>
                                <button class="quick-action-btn" onclick="alert('Member registration would open here')">
                                    <span class="icon">üë§</span>
                                    <span>New Member</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bookings Tab -->
                <div class="tab-panel" id="tab-bookings">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üìÖ All Bookings</h2>
                            <div class="filters-row">
                                <select class="filter-select" id="filterStatus">
                                    <option value="">All Status</option>
                                    <option value="confirmed">Confirmed</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                                <button class="btn btn-primary btn-sm" onclick="openAddBookingModal()">+ Add Booking</button>
                            </div>
                        </div>
                        <div class="admin-card-body" id="bookingsAccordion">
                            <!-- Date accordions will be rendered here -->
                        </div>
                    </div>
                </div>
                
                <!-- Dogs Tab -->
                <div class="tab-panel" id="tab-dogs">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üêï Registered Dogs</h2>
                            <div class="filters-row">
                                <input type="text" class="filter-input" id="filterDogSearch" placeholder="Search dogs or owners...">
                            </div>
                        </div>
                        <div class="admin-card-body">
                            <div class="dogs-grid" id="dogsGrid">
                                <!-- Dog cards will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Members Tab -->
                <div class="tab-panel" id="tab-members">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üë• All Members</h2>
                            <div class="filters-row">
                                <input type="text" class="filter-input" id="filterMemberSearch" placeholder="Search members...">
                                <button class="btn btn-outline btn-sm" onclick="resetDemoData()" style="margin-left: auto;">üîÑ Reset Demo Data</button>
                            </div>
                        </div>
                        <div class="data-table-wrapper">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Member</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Dogs</th>
                                        <th>Full Day</th>
                                        <th>Half Day</th>
                                        <th>3 Hour</th>
                                        <th>Hydro 30</th>
                                        <th>Hydro 60</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="allMembersBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Blog Tab -->
                <div class="tab-panel" id="tab-blog">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üìù Blog Posts</h2>
                            <button class="btn btn-primary btn-sm" onclick="openBlogModal()">+ New Post</button>
                        </div>
                        <div class="admin-card-body">
                            <div class="blog-posts-grid" id="blogPostsGrid">
                                <!-- Blog posts loaded via JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gallery Tab -->
                <div class="tab-panel" id="tab-gallery">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h2>üì∏ Gallery</h2>
                            <button class="btn btn-primary btn-sm" onclick="openGalleryUpload()">+ Add Photos</button>
                        </div>
                        <div class="admin-card-body">
                            <div class="gallery-grid" id="galleryGrid">
                                <!-- Gallery images loaded via JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Edit Credits Modal -->
    <div class="admin-modal" id="creditsModal">
        <div class="admin-modal-backdrop" onclick="closeCreditsModal()"></div>
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h2>üí≥ Manage Credits</h2>
                <button class="admin-modal-close" onclick="closeCreditsModal()">‚úï</button>
            </div>
            <div class="admin-modal-body">
                <div id="memberInfo" style="margin-bottom: var(--space-5); padding-bottom: var(--space-4); border-bottom: 2px dashed var(--color-gray-200);"></div>
                
                <h4 style="margin-bottom: var(--space-4);">Credit Balances</h4>
                <div class="form-group">
                    <label>Full Day Credits</label>
                    <div class="credit-adjust">
                        <button class="minus" onclick="adjustCredit('fullDay', -1)">‚àí</button>
                        <input type="number" id="creditFullDay" value="0" min="0">
                        <button class="plus" onclick="adjustCredit('fullDay', 1)">+</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Half Day Credits</label>
                    <div class="credit-adjust">
                        <button class="minus" onclick="adjustCredit('halfDay', -1)">‚àí</button>
                        <input type="number" id="creditHalfDay" value="0" min="0">
                        <button class="plus" onclick="adjustCredit('halfDay', 1)">+</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>3 Hour Credits</label>
                    <div class="credit-adjust">
                        <button class="minus" onclick="adjustCredit('threeHour', -1)">‚àí</button>
                        <input type="number" id="creditThreeHour" value="0" min="0">
                        <button class="plus" onclick="adjustCredit('threeHour', 1)">+</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Rehab 30min Credits</label>
                    <div class="credit-adjust">
                        <button class="minus" onclick="adjustCredit('rehab30', -1)">‚àí</button>
                        <input type="number" id="creditRehab30" value="0" min="0">
                        <button class="plus" onclick="adjustCredit('rehab30', 1)">+</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Rehab 60min Credits</label>
                    <div class="credit-adjust">
                        <button class="minus" onclick="adjustCredit('rehab60', -1)">‚àí</button>
                        <input type="number" id="creditRehab60" value="0" min="0">
                        <button class="plus" onclick="adjustCredit('rehab60', 1)">+</button>
                    </div>
                </div>
            </div>
            <div class="admin-modal-footer">
                <button class="btn btn-outline" onclick="closeCreditsModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveCredits()">Save Changes</button>
            </div>
        </div>
    </div>
    
    <!-- Add Booking Modal -->
    <div class="admin-modal" id="bookingModal">
        <div class="admin-modal-backdrop" onclick="closeBookingModal()"></div>
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h2>‚ûï Add Booking</h2>
                <button class="admin-modal-close" onclick="closeBookingModal()">‚úï</button>
            </div>
            <div class="admin-modal-body">
                <div class="form-group">
                    <label>Select Dog</label>
                    <select id="bookingDogSelect">
                        <option value="">Choose a dog...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Service Type</label>
                    <select id="bookingTypeSelect" onchange="updateSessionOptions()">
                        <option value="daycare">Daycare</option>
                        <option value="hydrotherapy">Hydrotherapy</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Session</label>
                    <select id="bookingSessionSelect"></select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="bookingDateInput">
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <input type="time" id="bookingTimeInput" value="08:00">
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes (optional)</label>
                    <input type="text" id="bookingNotesInput" placeholder="Any special notes...">
                </div>
            </div>
            <div class="admin-modal-footer">
                <button class="btn btn-outline" onclick="closeBookingModal()">Cancel</button>
                <button class="btn btn-primary" onclick="createBooking()">Create Booking</button>
            </div>
        </div>
    </div>
    
    <!-- Dog Details Modal -->
    <div class="admin-modal" id="dogDetailsModal">
        <div class="admin-modal-backdrop" onclick="closeDogDetailsModal()"></div>
        <div class="admin-modal-content" style="max-width: 600px;">
            <div class="admin-modal-header">
                <h2>üêï Dog Details</h2>
                <button class="admin-modal-close" onclick="closeDogDetailsModal()">‚úï</button>
            </div>
            <div class="admin-modal-body" id="dogDetailsContent">
                <!-- Dog details loaded via JS -->
            </div>
            <div class="admin-modal-footer">
                <button class="btn btn-outline" onclick="closeDogDetailsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Blog Post Modal -->
    <div class="admin-modal" id="blogModal">
        <div class="admin-modal-backdrop" onclick="closeBlogModal()"></div>
        <div class="admin-modal-content" style="max-width: 700px;">
            <div class="admin-modal-header">
                <h2 id="blogModalTitle">New Blog Post</h2>
                <button class="admin-modal-close" onclick="closeBlogModal()">‚úï</button>
            </div>
            <div class="admin-modal-body">
                <form id="blogForm">
                    <input type="hidden" id="blogPostId">
                    <div class="form-group">
                        <label>Title *</label>
                        <input type="text" id="blogTitle" required placeholder="Enter post title...">
                    </div>
                    <div class="form-group">
                        <label>Excerpt *</label>
                        <input type="text" id="blogExcerpt" required placeholder="Short description for listing...">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="blogCategory">
                            <option value="Tips & Advice">Tips & Advice</option>
                            <option value="News">News</option>
                            <option value="Events">Events</option>
                            <option value="Health">Health</option>
                            <option value="Training">Training</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Featured Image URL</label>
                        <input type="url" id="blogImage" placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="form-group">
                        <label>Content *</label>
                        <textarea id="blogContent" rows="10" required placeholder="Write your blog post content..." style="width:100%;padding:var(--space-3);border:2px solid var(--color-gray-200);border-radius:var(--radius-lg);resize:vertical;"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-item" style="display:flex;align-items:center;gap:var(--space-2);">
                            <input type="checkbox" id="blogPublished" checked>
                            Published (visible on website)
                        </label>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn btn-outline" onclick="closeBlogModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveBlogPost()">Save Post</button>
            </div>
        </div>
    </div>

    <!-- Gallery Upload Modal -->
    <div class="admin-modal" id="galleryModal">
        <div class="admin-modal-backdrop" onclick="closeGalleryModal()"></div>
        <div class="admin-modal-content" style="max-width: 500px;">
            <div class="admin-modal-header">
                <h2>üì∏ Add Photo</h2>
                <button class="admin-modal-close" onclick="closeGalleryModal()">‚úï</button>
            </div>
            <div class="admin-modal-body">
                <form id="galleryForm">
                    <div class="form-group">
                        <label>Image URL *</label>
                        <input type="url" id="galleryImageUrl" required placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="form-group">
                        <label>Caption</label>
                        <input type="text" id="galleryCaption" placeholder="Photo caption...">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="galleryCategory">
                            <option value="daycare">Day Care</option>
                            <option value="hydrotherapy">Hydrotherapy</option>
                            <option value="facility">Facility</option>
                            <option value="events">Events</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn btn-outline" onclick="closeGalleryModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveGalleryImage()">Add Photo</button>
            </div>
        </div>
    </div>

    <script src="../js/services/mockAuth.js"></script>
    <script src="../js/services/mockDatabase.js"></script>
    <script>
        // Tab Navigation
        const tabLinks = document.querySelectorAll('.sidebar-link[data-tab]');
        const tabPanels = document.querySelectorAll('.tab-panel');
        const pageTitle = document.getElementById('pageTitle');
        
        const tabTitles = {
            'overview': 'Admin Overview',
            'bookings': 'All Bookings',
            'dogs': 'All Dogs',
            'members': 'All Members',
            'blog': 'Blog Posts',
            'gallery': 'Gallery'
        };
        
        tabLinks.forEach(link => {
            link.addEventListener('click', () => {
                const tabId = link.dataset.tab;
                tabLinks.forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                tabPanels.forEach(panel => {
                    panel.classList.remove('active');
                    if (panel.id === 'tab-' + tabId) panel.classList.add('active');
                });
                pageTitle.textContent = tabTitles[tabId] || 'Admin Dashboard';
                document.getElementById('sidebar').classList.remove('open');
                document.getElementById('sidebarOverlay').classList.remove('open');
            });
        });
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebarOverlay').classList.toggle('open');
        }
        
        function logout() {
            MockAuth.signOut().then(() => {
                window.location.href = '../login.html';
            });
        }
        
        // Auth check
        const user = MockAuth.getCurrentUser();
        if (!user || user.role !== 'admin') {
            window.location.href = 'dashboard.html';
        }
        
        // Update sidebar user
        document.getElementById('sidebarUser').innerHTML = `
            <div class="sidebar-user-avatar">üë§</div>
            <div class="sidebar-user-name">${user.displayName}</div>
            <div class="sidebar-user-email">${user.email}</div>
        `;
        
        // Set current date
        const today = new Date();
        document.getElementById('currentDate').textContent = today.toLocaleDateString('en-NZ', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('todayDate').textContent = today.toLocaleDateString('en-NZ', { weekday: 'short', month: 'short', day: 'numeric' });
        
        // Data helpers - use MockDatabase to ensure initialization
        function getCollection(name) {
            // This ensures MockDatabase initializes the collection first
            return MockDatabase.getCollectionSync(name);
        }
        
        function saveCollection(name, data) {
            localStorage.setItem('gooddogspa_db_' + name, JSON.stringify(data));
        }
        
        function getCreditsForUser(userId) {
            const credits = JSON.parse(localStorage.getItem('gooddogspa_db_credits') || '{}');
            return credits[userId] || { fullDay: 0, halfDay: 0, threeHour: 0, rehab30: 0, rehab60: 0 };
        }
        
        function saveCreditsForUser(userId, credits) {
            const allCredits = JSON.parse(localStorage.getItem('gooddogspa_db_credits') || '{}');
            allCredits[userId] = credits;
            localStorage.setItem('gooddogspa_db_credits', JSON.stringify(allCredits));
        }
        
        // Initialize data through MockDatabase
        MockDatabase.initAllCollections();
        
        const allUsers = JSON.parse(localStorage.getItem('gooddogspa_users') || '[]').filter(u => u.role === 'member');
        const allDogs = getCollection('dogs');
        const allBookings = getCollection('bookings');
        
        function getUserById(uid) {
            const users = JSON.parse(localStorage.getItem('gooddogspa_users') || '[]');
            return users.find(u => u.uid === uid) || { displayName: 'Unknown', email: '-' };
        }
        
        function getDogById(id) {
            return allDogs.find(d => d.id === id) || { name: 'Unknown' };
        }
        
        function formatDate(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('en-NZ', { weekday: 'short', day: 'numeric', month: 'short' });
        }
        
        // Calculate stats
        const todayStr = today.toISOString().split('T')[0];
        const todayBookings = allBookings.filter(b => b.date === todayStr && b.status !== 'cancelled');
        
        const weekFromNow = new Date(today);
        weekFromNow.setDate(weekFromNow.getDate() + 7);
        const weekBookings = allBookings.filter(b => {
            const bookingDate = new Date(b.date);
            return bookingDate >= today && bookingDate <= weekFromNow && b.status !== 'cancelled';
        });
        
        document.getElementById('statTodayBookings').textContent = todayBookings.length;
        document.getElementById('statTotalDogs').textContent = allDogs.length;
        document.getElementById('statTotalMembers').textContent = allUsers.length;
        document.getElementById('statWeekBookings').textContent = weekBookings.length;
        
        // Today's Schedule - Card Format
        const scheduleContainer = document.getElementById('todaySchedule');
        if (todayBookings.length > 0) {
            scheduleContainer.innerHTML = todayBookings.map(booking => {
                const dog = getDogById(booking.dogId);
                const time = booking.dropOff || booking.time || '09:00';
                const isHydro = booking.type === 'hydrotherapy';
                return `
                    <div class="schedule-card ${isHydro ? 'hydro' : 'daycare'}">
                        <div class="time">${time}</div>
                        <div class="avatar">
                            ${dog.photo ? `<img src="${dog.photo}" alt="${booking.dogName}">` : 'üêï'}
                        </div>
                        <div class="info">
                            <h4>${booking.dogName}</h4>
                            <p>${isHydro ? 'üíß Hydro' : 'üè† Daycare'} ‚Ä¢ ${booking.session || ''}</p>
                        </div>
                    </div>
                `;
            }).join('');
        } else {
            scheduleContainer.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì≠</div><p>No bookings today</p></div>';
        }
        
        // Helper to switch tabs
        function switchToTab(tabId) {
            document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
            document.querySelector(`[data-tab="${tabId}"]`)?.classList.add('active');
            document.getElementById('tab-' + tabId)?.classList.add('active');
        }
        
        // All Bookings - Date Accordion Format
        function renderAllBookings(bookings) {
            const container = document.getElementById('bookingsAccordion');
            
            // Group by date
            const grouped = {};
            bookings.forEach(b => {
                if (!grouped[b.date]) grouped[b.date] = [];
                grouped[b.date].push(b);
            });
            
            // Sort dates descending (newest first)
            const sortedDates = Object.keys(grouped).sort((a, b) => new Date(b) - new Date(a));
            
            if (sortedDates.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì≠</div><p>No bookings found</p></div>';
                return;
            }
            
            container.innerHTML = sortedDates.map(date => {
                const dateBookings = grouped[date];
                const daycare = dateBookings.filter(b => b.type === 'daycare');
                const hydro = dateBookings.filter(b => b.type === 'hydrotherapy');
                const dateObj = new Date(date + 'T00:00:00');
                const dateLabel = dateObj.toLocaleDateString('en-NZ', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
                
                return `
                    <div class="date-accordion">
                        <div class="date-header" onclick="toggleAccordion(this)">
                            <h3>üìÖ ${dateLabel}</h3>
                            <div style="display:flex;align-items:center;gap:var(--space-3);">
                                <span class="date-count">${dateBookings.length} booking${dateBookings.length !== 1 ? 's' : ''}</span>
                                <span class="toggle-icon">‚ñº</span>
                            </div>
                        </div>
                        <div class="date-content">
                            ${daycare.length > 0 ? `
                                <div class="service-section">
                                    <div class="service-section-header">üè† Day Care (${daycare.length})</div>
                                    <div class="booking-cards">
                                        ${daycare.map(b => renderBookingCard(b)).join('')}
                                    </div>
                                </div>
                            ` : ''}
                            ${hydro.length > 0 ? `
                                <div class="service-section">
                                    <div class="service-section-header">üíß Hydrotherapy (${hydro.length})</div>
                                    <div class="booking-cards">
                                        ${hydro.map(b => renderBookingCard(b)).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function renderBookingCard(b) {
            const dog = getDogById(b.dogId);
            const time = b.dropOff ? `${b.dropOff} - ${b.pickUp}` : (b.time || 'TBD');
            return `
                <div class="booking-card-mini">
                    <div class="dog-avatar">
                        ${dog.photo ? `<img src="${dog.photo}" alt="${b.dogName}">` : 'üêï'}
                    </div>
                    <div class="booking-info">
                        <h4>${b.dogName}</h4>
                        <p class="time">${time}</p>
                        <p>${b.session || b.type}</p>
                        <span class="status-badge ${b.status}" style="margin-top:4px;">${b.status}</span>
                    </div>
                    <div class="edit-btn" onclick="openEditBookingModal('${b.id}')" title="Edit booking">‚úèÔ∏è</div>
                </div>
            `;
        }
        
        function toggleAccordion(header) {
            header.classList.toggle('open');
            header.nextElementSibling.classList.toggle('open');
        }
        
        function openEditBookingModal(id) {
            alert('Edit booking modal for: ' + id + '\n\nThis would open an edit form for the booking.');
        }
        
        renderAllBookings(allBookings);
        
        // Booking filters
        document.getElementById('filterStatus').addEventListener('change', applyBookingFilters);
        
        function applyBookingFilters() {
            let filtered = [...allBookings];
            const status = document.getElementById('filterStatus').value;
            
            if (status) filtered = filtered.filter(b => b.status === status);
            
            renderAllBookings(filtered);
        }
        
        function completeBooking(id) {
            if (confirm('Mark this booking as completed?')) {
                const bookings = getCollection('bookings');
                const idx = bookings.findIndex(b => b.id === id);
                if (idx > -1) {
                    bookings[idx].status = 'completed';
                    saveCollection('bookings', bookings);
                    location.reload();
                }
            }
        }
        
        function cancelBooking(id) {
            if (confirm('Cancel this booking? Credits will be refunded if applicable.')) {
                const bookings = getCollection('bookings');
                const idx = bookings.findIndex(b => b.id === id);
                if (idx > -1) {
                    const booking = bookings[idx];
                    // Refund credits if paid with credits
                    if (booking.paidWithCredits && booking.creditType) {
                        const credits = getCreditsForUser(booking.ownerId);
                        credits[booking.creditType] = (credits[booking.creditType] || 0) + 1;
                        saveCreditsForUser(booking.ownerId, credits);
                    }
                    bookings[idx].status = 'cancelled';
                    saveCollection('bookings', bookings);
                    location.reload();
                }
            }
        }
        
        // All Dogs - Card Format (click opens modal)
        function renderAllDogs(dogs) {
            const grid = document.getElementById('dogsGrid');
            grid.innerHTML = dogs.map(d => {
                const owner = getUserById(d.ownerId);
                return `
                    <div class="dog-card" onclick="openDogDetailsModal('${d.id}')">
                        <div class="dog-card-main">
                            <div class="dog-card-avatar">
                                ${d.photo ? `<img src="${d.photo}" alt="${d.name}">` : 'üêï'}
                            </div>
                            <div class="dog-card-info">
                                <h3>${d.name}</h3>
                                <p class="owner">üë§ ${owner.displayName}</p>
                                <div class="dog-card-tags">
                                    <span>${d.breed}</span>
                                    <span>${d.gender}</span>
                                    <span>${d.age} yrs</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('') || '<div class="empty-state"><div class="empty-state-icon">üêï</div><p>No dogs found</p></div>';
        }

        // Dog Details Modal
        function openDogDetailsModal(dogId) {
            const dog = allDogs.find(d => d.id === dogId);
            if (!dog) return;

            const owner = getUserById(dog.ownerId);
            const credits = getCreditsForUser(dog.ownerId);
            const totalCredits = Object.values(credits).reduce((a, b) => a + b, 0);

            document.getElementById('dogDetailsContent').innerHTML = `
                <div class="dog-detail-header">
                    <div class="dog-detail-avatar">
                        ${dog.photo ? `<img src="${dog.photo}" alt="${dog.name}">` : 'üêï'}
                    </div>
                    <div class="dog-detail-info">
                        <h3>${dog.name}</h3>
                        <p>${dog.breed} ‚Ä¢ ${dog.gender}</p>
                        <p style="margin-top:var(--space-2);">
                            <span class="status-badge ${dog.assessmentPassed ? 'confirmed' : 'pending'}">
                                ${dog.assessmentPassed ? '‚úì Assessment Passed' : 'Assessment Pending'}
                            </span>
                        </p>
                    </div>
                </div>

                <div class="dog-detail-grid">
                    <div class="dog-detail-item">
                        <div class="label">Age</div>
                        <div class="value">${dog.age} years</div>
                    </div>
                    <div class="dog-detail-item">
                        <div class="label">Weight</div>
                        <div class="value">${dog.weight || 'Not specified'} kg</div>
                    </div>
                    <div class="dog-detail-item">
                        <div class="label">Owner</div>
                        <div class="value">${owner.displayName}</div>
                    </div>
                    <div class="dog-detail-item">
                        <div class="label">Owner Phone</div>
                        <div class="value">${owner.phone || '-'}</div>
                    </div>
                    <div class="dog-detail-item">
                        <div class="label">Owner Email</div>
                        <div class="value">${owner.email}</div>
                    </div>
                    <div class="dog-detail-item">
                        <div class="label">Owner Credits</div>
                        <div class="value">${totalCredits} total</div>
                    </div>
                </div>

                ${dog.medicalNotes ? `
                <div class="dog-notes-section">
                    <h4>üè• Medical Notes</h4>
                    <p>${dog.medicalNotes}</p>
                </div>` : ''}

                ${dog.behaviourNotes ? `
                <div class="dog-notes-section">
                    <h4>üêæ Behaviour Notes</h4>
                    <p>${dog.behaviourNotes}</p>
                </div>` : ''}

                <div style="display:flex;gap:var(--space-2);margin-top:var(--space-5);">
                    <button class="btn btn-outline" onclick="openCreditsModal('${dog.ownerId}'); closeDogDetailsModal();">üí≥ Manage Credits</button>
                </div>
            `;

            document.getElementById('dogDetailsModal').classList.add('open');
        }

        function closeDogDetailsModal() {
            document.getElementById('dogDetailsModal').classList.remove('open');
        }
        
        renderAllDogs(allDogs);
        
        // Dogs filter
        document.getElementById('filterDogSearch').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const filtered = allDogs.filter(d => {
                const owner = getUserById(d.ownerId);
                return d.name.toLowerCase().includes(search) ||
                       d.breed.toLowerCase().includes(search) ||
                       owner.displayName.toLowerCase().includes(search);
            });
            renderAllDogs(filtered);
        });
        
        // All Members Table
        function renderAllMembers(members) {
            const body = document.getElementById('allMembersBody');
            body.innerHTML = members.map(m => {
                const credits = getCreditsForUser(m.uid);
                const userDogs = allDogs.filter(d => d.ownerId === m.uid);
                return `
                    <tr>
                        <td>
                            <div class="item-row">
                                <div class="item-avatar member">üë§</div>
                                <div class="item-info">
                                    <h4>${m.displayName}</h4>
                                    <p>Since ${new Date(m.createdAt).toLocaleDateString('en-NZ', { month: 'short', year: 'numeric' })}</p>
                                </div>
                            </div>
                        </td>
                        <td>${m.email}</td>
                        <td>${m.phone || '-'}</td>
                        <td>${userDogs.length} dog${userDogs.length !== 1 ? 's' : ''}</td>
                        <td><strong>${credits.fullDay || 0}</strong></td>
                        <td><strong>${credits.halfDay || 0}</strong></td>
                        <td><strong>${credits.threeHour || 0}</strong></td>
                        <td><strong>${credits.rehab30 || 0}</strong></td>
                        <td><strong>${credits.rehab60 || 0}</strong></td>
                        <td>
                            <button class="action-btn edit" onclick="openCreditsModal('${m.uid}')">üí≥ Edit</button>
                        </td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="10" class="empty-state">No members found</td></tr>';
        }
        
        renderAllMembers(allUsers);
        
        // Members filter
        document.getElementById('filterMemberSearch').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const filtered = allUsers.filter(m => 
                m.displayName.toLowerCase().includes(search) ||
                m.email.toLowerCase().includes(search) ||
                (m.phone && m.phone.includes(search))
            );
            renderAllMembers(filtered);
        });
        
        // Reset Demo Data function
        function resetDemoData() {
            if (confirm('This will reset all demo data to defaults. Any changes you made will be lost. Continue?')) {
                // Clear all gooddogspa localStorage
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('gooddogspa')) {
                        localStorage.removeItem(key);
                    }
                });
                alert('Demo data reset! The page will now reload.');
                location.reload();
            }
        }
        
        // Credits Modal
        let currentEditUserId = null;
        
        function openCreditsModal(userId) {
            currentEditUserId = userId;
            const user = getUserById(userId);
            const credits = getCreditsForUser(userId);
            
            document.getElementById('memberInfo').innerHTML = `
                <div class="item-row">
                    <div class="item-avatar member">üë§</div>
                    <div class="item-info">
                        <h4>${user.displayName}</h4>
                        <p>${user.email} ‚Ä¢ ${user.phone || 'No phone'}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('creditFullDay').value = credits.fullDay || 0;
            document.getElementById('creditHalfDay').value = credits.halfDay || 0;
            document.getElementById('creditThreeHour').value = credits.threeHour || 0;
            document.getElementById('creditRehab30').value = credits.rehab30 || 0;
            document.getElementById('creditRehab60').value = credits.rehab60 || 0;
            
            document.getElementById('creditsModal').classList.add('open');
        }
        
        function closeCreditsModal() {
            document.getElementById('creditsModal').classList.remove('open');
            currentEditUserId = null;
        }
        
        function adjustCredit(type, delta) {
            const input = document.getElementById('credit' + type.charAt(0).toUpperCase() + type.slice(1));
            let val = parseInt(input.value) || 0;
            val = Math.max(0, val + delta);
            input.value = val;
        }
        
        function saveCredits() {
            if (!currentEditUserId) return;
            
            const credits = {
                fullDay: parseInt(document.getElementById('creditFullDay').value) || 0,
                halfDay: parseInt(document.getElementById('creditHalfDay').value) || 0,
                threeHour: parseInt(document.getElementById('creditThreeHour').value) || 0,
                rehab30: parseInt(document.getElementById('creditRehab30').value) || 0,
                rehab60: parseInt(document.getElementById('creditRehab60').value) || 0
            };
            
            saveCreditsForUser(currentEditUserId, credits);
            closeCreditsModal();
            alert('Credits updated successfully!');
            renderAllDogs(allDogs);
        }
        
        // Add Booking Modal
        function openAddBookingModal() {
            // Populate dogs dropdown
            const select = document.getElementById('bookingDogSelect');
            select.innerHTML = '<option value="">Choose a dog...</option>' +
                allDogs.map(d => {
                    const owner = getUserById(d.ownerId);
                    return `<option value="${d.id}" data-owner="${d.ownerId}">${d.name} (${owner.displayName})</option>`;
                }).join('');
            
            // Set default date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('bookingDateInput').value = tomorrow.toISOString().split('T')[0];
            
            updateSessionOptions();
            document.getElementById('bookingModal').classList.add('open');
        }
        
        function closeBookingModal() {
            document.getElementById('bookingModal').classList.remove('open');
        }
        
        function updateSessionOptions() {
            const type = document.getElementById('bookingTypeSelect').value;
            const select = document.getElementById('bookingSessionSelect');
            
            if (type === 'daycare') {
                select.innerHTML = `
                    <option value="full">Full Day (7am-6pm)</option>
                    <option value="half-am">Half Day AM (7am-12:30pm)</option>
                    <option value="half-pm">Half Day PM (12:30pm-6pm)</option>
                    <option value="3hour">3 Hour Stay</option>
                `;
            } else {
                select.innerHTML = `
                    <option value="30min">30 Minute Session</option>
                    <option value="60min">60 Minute Session</option>
                `;
            }
        }
        
        function createBooking() {
            const dogId = document.getElementById('bookingDogSelect').value;
            const type = document.getElementById('bookingTypeSelect').value;
            const session = document.getElementById('bookingSessionSelect').value;
            const date = document.getElementById('bookingDateInput').value;
            const time = document.getElementById('bookingTimeInput').value;
            const notes = document.getElementById('bookingNotesInput').value;

            if (!dogId || !date) {
                alert('Please select a dog and date');
                return;
            }

            const dog = getDogById(dogId);
            const option = document.getElementById('bookingDogSelect').selectedOptions[0];
            const ownerId = option.dataset.owner;

            const bookingData = {
                id: 'booking-' + Date.now(),
                ownerId: ownerId,
                dogId: dogId,
                dogName: dog.name,
                type: type,
                sessionType: session,
                date: date,
                status: 'confirmed',
                notes: notes,
                paidWithCredits: false,
                createdAt: new Date().toISOString()
            };

            if (type === 'daycare') {
                bookingData.dropOff = time || '08:00';
                bookingData.pickUp = session === 'half-am' ? '12:30' : session === 'half-pm' ? '18:00' : '17:00';
            } else {
                bookingData.time = time || '10:00';
            }

            const bookings = getCollection('bookings');
            bookings.push(bookingData);
            saveCollection('bookings', bookings);

            closeBookingModal();
            alert('Booking created successfully!');
            location.reload();
        }

        // ========== BLOG MANAGEMENT ==========
        const BLOG_DATA_VERSION = 'v2'; // Increment to force refresh of demo data
        function getBlogPosts() {
            const version = localStorage.getItem('gooddogspa_blogVersion');
            const posts = localStorage.getItem('gooddogspa_db_blogPosts');
            // Reset if no data OR if version has changed
            if (!posts || version !== BLOG_DATA_VERSION) {
                localStorage.setItem('gooddogspa_blogVersion', BLOG_DATA_VERSION);
                // Initialize with posts matching the website blog page
                const samplePosts = [
                    {
                        id: 'post-1',
                        title: 'The Benefits of Hydrotherapy for Senior Dogs',
                        excerpt: 'Discover how underwater treadmill therapy can help your aging companion maintain mobility and improve quality of life.',
                        content: 'Discover how underwater treadmill therapy can help your aging companion maintain mobility, reduce joint pain, and improve quality of life. Our AQUATREAD system offers a low-impact solution for dogs with arthritis and mobility issues.',
                        category: 'Health',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2024/05/54dcc163.jpg',
                        published: true,
                        createdAt: '2025-01-10T10:00:00Z'
                    },
                    {
                        id: 'post-2',
                        title: 'Why Socialisation is Important for Your Dog',
                        excerpt: 'Learn how regular interaction with other dogs can improve your pet\'s behaviour and reduce anxiety.',
                        content: 'Learn how regular interaction with other dogs can improve your pet\'s behaviour, reduce anxiety, and create a happier, more confident companion.',
                        category: 'Tips & Advice',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3118-450x350.jpg',
                        published: true,
                        createdAt: '2025-01-05T14:30:00Z'
                    },
                    {
                        id: 'post-3',
                        title: 'Post-Surgery Recovery: What to Expect',
                        excerpt: 'A guide to helping your dog recover after orthopaedic surgery with rehabilitation therapy.',
                        content: 'A guide to helping your dog recover after orthopaedic surgery. Tips on rest, exercise restrictions, and how rehabilitation therapy can speed recovery.',
                        category: 'Health',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3121-1024x683-450x350.jpg',
                        published: true,
                        createdAt: '2024-12-28T09:00:00Z'
                    },
                    {
                        id: 'post-4',
                        title: 'Preparing Your Dog for Their First Daycare Visit',
                        excerpt: 'Nervous about your pup\'s first day? Here\'s everything you need to know.',
                        content: 'Nervous about your pup\'s first day? Here\'s everything you need to know to set them up for success at doggy daycare.',
                        category: 'Tips & Advice',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3123-768x1024-450x350.jpg',
                        published: true,
                        createdAt: '2024-12-20T11:00:00Z'
                    },
                    {
                        id: 'post-5',
                        title: 'Mondays Now Reserved for Small Breeds!',
                        excerpt: 'Great news for small dog owners! Mondays are now exclusively for small breeds.',
                        content: 'Great news for small dog owners! We\'ve dedicated Mondays exclusively to small breeds, ensuring a safer and more comfortable environment for your little ones.',
                        category: 'News',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3130-1024x683-450x350.jpg',
                        published: true,
                        createdAt: '2024-12-15T10:00:00Z'
                    },
                    {
                        id: 'post-6',
                        title: 'Understanding Canine Arthritis: Signs & Treatments',
                        excerpt: 'Learn to recognise the signs of arthritis and discover how hydrotherapy can help.',
                        content: 'Is your dog slowing down? Learn to recognise the signs of arthritis and discover how hydrotherapy can help manage pain and improve mobility.',
                        category: 'Health',
                        image: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3127-683x1024-450x350.jpg',
                        published: true,
                        createdAt: '2024-12-08T14:00:00Z'
                    }
                ];
                localStorage.setItem('gooddogspa_db_blogPosts', JSON.stringify(samplePosts));
                return samplePosts;
            }
            return JSON.parse(posts);
        }

        function saveBlogPosts(posts) {
            localStorage.setItem('gooddogspa_db_blogPosts', JSON.stringify(posts));
        }

        function renderBlogPosts() {
            const posts = getBlogPosts();
            const grid = document.getElementById('blogPostsGrid');

            if (posts.length === 0) {
                grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üìù</div><p>No blog posts yet. Create your first post!</p></div>';
                return;
            }

            grid.innerHTML = posts.map(post => `
                <div class="blog-post-card">
                    ${post.image ? `<img src="${post.image}" alt="${post.title}" class="blog-post-image">` : '<div class="blog-post-image" style="display:flex;align-items:center;justify-content:center;font-size:2rem;">üìù</div>'}
                    <div class="blog-post-content">
                        <span class="blog-post-category">${post.category}</span>
                        <h3>${post.title}</h3>
                        <p>${post.excerpt}</p>
                        <div class="blog-post-meta">
                            <span>${new Date(post.createdAt).toLocaleDateString('en-NZ', { day: 'numeric', month: 'short', year: 'numeric' })}</span>
                            <span class="status-badge ${post.published ? 'confirmed' : 'pending'}">${post.published ? 'Published' : 'Draft'}</span>
                        </div>
                        <div class="blog-post-actions">
                            <button class="action-btn edit" onclick="editBlogPost('${post.id}')">‚úèÔ∏è Edit</button>
                            <button class="action-btn cancel" onclick="deleteBlogPost('${post.id}')">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openBlogModal(postId = null) {
            document.getElementById('blogPostId').value = '';
            document.getElementById('blogTitle').value = '';
            document.getElementById('blogExcerpt').value = '';
            document.getElementById('blogCategory').value = 'Tips & Advice';
            document.getElementById('blogImage').value = '';
            document.getElementById('blogContent').value = '';
            document.getElementById('blogPublished').checked = true;
            document.getElementById('blogModalTitle').textContent = 'New Blog Post';

            document.getElementById('blogModal').classList.add('open');
        }

        function editBlogPost(postId) {
            const posts = getBlogPosts();
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            document.getElementById('blogPostId').value = post.id;
            document.getElementById('blogTitle').value = post.title;
            document.getElementById('blogExcerpt').value = post.excerpt;
            document.getElementById('blogCategory').value = post.category;
            document.getElementById('blogImage').value = post.image || '';
            document.getElementById('blogContent').value = post.content;
            document.getElementById('blogPublished').checked = post.published;
            document.getElementById('blogModalTitle').textContent = 'Edit Blog Post';

            document.getElementById('blogModal').classList.add('open');
        }

        function closeBlogModal() {
            document.getElementById('blogModal').classList.remove('open');
        }

        function saveBlogPost() {
            const postId = document.getElementById('blogPostId').value;
            const title = document.getElementById('blogTitle').value.trim();
            const excerpt = document.getElementById('blogExcerpt').value.trim();
            const category = document.getElementById('blogCategory').value;
            const image = document.getElementById('blogImage').value.trim();
            const content = document.getElementById('blogContent').value.trim();
            const published = document.getElementById('blogPublished').checked;

            if (!title || !excerpt || !content) {
                alert('Please fill in all required fields (Title, Excerpt, Content)');
                return;
            }

            const posts = getBlogPosts();

            if (postId) {
                // Edit existing
                const idx = posts.findIndex(p => p.id === postId);
                if (idx > -1) {
                    posts[idx] = { ...posts[idx], title, excerpt, category, image, content, published, updatedAt: new Date().toISOString() };
                }
            } else {
                // New post
                posts.unshift({
                    id: 'post-' + Date.now(),
                    title,
                    excerpt,
                    category,
                    image,
                    content,
                    published,
                    createdAt: new Date().toISOString()
                });
            }

            saveBlogPosts(posts);
            closeBlogModal();
            renderBlogPosts();
            alert('Blog post saved successfully!');
        }

        function deleteBlogPost(postId) {
            if (!confirm('Are you sure you want to delete this blog post?')) return;

            const posts = getBlogPosts();
            const filtered = posts.filter(p => p.id !== postId);
            saveBlogPosts(filtered);
            renderBlogPosts();
            alert('Blog post deleted.');
        }

        // ========== GALLERY MANAGEMENT ==========
        const GALLERY_DATA_VERSION = 'v2'; // Increment to force refresh of demo data
        function getGalleryImages() {
            const version = localStorage.getItem('gooddogspa_galleryVersion');
            const images = localStorage.getItem('gooddogspa_db_gallery');
            // Reset if no data OR if version has changed
            if (!images || version !== GALLERY_DATA_VERSION) {
                localStorage.setItem('gooddogspa_galleryVersion', GALLERY_DATA_VERSION);
                // Initialize with images matching the website gallery page
                const sampleImages = [
                    { id: 'img-1', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3130.jpg', caption: 'Play Time!', category: 'daycare', createdAt: '2025-01-10T10:00:00Z' },
                    { id: 'img-2', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3121.jpg', caption: 'Best Friends', category: 'daycare', createdAt: '2025-01-09T14:00:00Z' },
                    { id: 'img-3', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3111.jpg', caption: 'So Much Fun', category: 'daycare', createdAt: '2025-01-08T09:00:00Z' },
                    { id: 'img-4', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3105.jpg', caption: 'Living Life', category: 'daycare', createdAt: '2025-01-07T11:00:00Z' },
                    { id: 'img-5', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3094.jpg', caption: 'Spa Day', category: 'daycare', createdAt: '2025-01-06T10:00:00Z' },
                    { id: 'img-6', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3125.jpg', caption: 'Good Times', category: 'daycare', createdAt: '2025-01-05T15:00:00Z' },
                    { id: 'img-7', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3129.jpg', caption: 'Group Play', category: 'daycare', createdAt: '2025-01-04T12:00:00Z' },
                    { id: 'img-8', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3127.jpg', caption: 'Hydrotherapy Session', category: 'hydrotherapy', createdAt: '2025-01-03T10:00:00Z' },
                    { id: 'img-9', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3128.jpg', caption: 'Water Work', category: 'hydrotherapy', createdAt: '2025-01-02T11:00:00Z' },
                    { id: 'img-10', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3126.jpg', caption: 'Smiles', category: 'daycare', createdAt: '2025-01-01T14:00:00Z' },
                    { id: 'img-11', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3123.jpg', caption: 'Playful', category: 'daycare', createdAt: '2024-12-30T09:00:00Z' },
                    { id: 'img-12', url: 'https://wigramvet.co.nz/wp-content/uploads/2025/09/IMG_3118.jpg', caption: 'Daycare Fun', category: 'daycare', createdAt: '2024-12-28T16:00:00Z' }
                ];
                localStorage.setItem('gooddogspa_db_gallery', JSON.stringify(sampleImages));
                return sampleImages;
            }
            return JSON.parse(images);
        }

        function saveGalleryImages(images) {
            localStorage.setItem('gooddogspa_db_gallery', JSON.stringify(images));
        }

        function renderGallery() {
            const images = getGalleryImages();
            const grid = document.getElementById('galleryGrid');

            if (images.length === 0) {
                grid.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üì∏</div><p>No photos yet. Add your first photo!</p></div>';
                return;
            }

            grid.innerHTML = images.map(img => `
                <div class="gallery-item">
                    <img src="${img.url}" alt="${img.caption || 'Gallery image'}">
                    <div class="gallery-item-overlay">
                        <button class="delete-btn" onclick="deleteGalleryImage('${img.id}')" title="Delete photo">‚úï</button>
                        <p>${img.caption || ''}</p>
                        <span style="font-size:10px;color:rgba(255,255,255,0.7);text-transform:capitalize;">${img.category}</span>
                    </div>
                </div>
            `).join('');
        }

        function openGalleryUpload() {
            document.getElementById('galleryImageUrl').value = '';
            document.getElementById('galleryCaption').value = '';
            document.getElementById('galleryCategory').value = 'daycare';
            document.getElementById('galleryModal').classList.add('open');
        }

        function closeGalleryModal() {
            document.getElementById('galleryModal').classList.remove('open');
        }

        function saveGalleryImage() {
            const url = document.getElementById('galleryImageUrl').value.trim();
            const caption = document.getElementById('galleryCaption').value.trim();
            const category = document.getElementById('galleryCategory').value;

            if (!url) {
                alert('Please enter an image URL');
                return;
            }

            const images = getGalleryImages();
            images.unshift({
                id: 'img-' + Date.now(),
                url,
                caption,
                category,
                createdAt: new Date().toISOString()
            });

            saveGalleryImages(images);
            closeGalleryModal();
            renderGallery();
            alert('Photo added successfully!');
        }

        function deleteGalleryImage(imageId) {
            if (!confirm('Are you sure you want to delete this photo?')) return;

            const images = getGalleryImages();
            const filtered = images.filter(img => img.id !== imageId);
            saveGalleryImages(filtered);
            renderGallery();
        }

        // Initialize blog and gallery on page load
        renderBlogPosts();
        renderGallery();
    </script>
</body>
</html>
